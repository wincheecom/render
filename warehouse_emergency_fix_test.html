<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“¦ ä»“åº“ä»»åŠ¡å¡ç´§æ€¥ä¿®å¤éªŒè¯</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            padding: 20px;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .section-title {
            color: #4361ee;
            border-bottom: 2px solid #4361ee;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        /* æ¨¡æ‹Ÿé—®é¢˜æ ·å¼ - å‚ç›´æ˜¾ç¤º */
        .vertical-demo {
            display: block;
        }
        
        .vertical-demo .task-flip-container {
            display: block;
            width: 100%;
            margin-bottom: 15px;
        }
        
        /* ä¿®å¤åçš„æ ·å¼ - ç½‘æ ¼æ˜¾ç¤º */
        .fixed-demo {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        
        .fixed-demo .task-flip-container {
            display: block;
            width: 100%;
        }
        
        /* ä»»åŠ¡å¡ç‰‡åŸºç¡€æ ·å¼ */
        .task-flip-container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }
        
        .task-flip-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
        }
        
        .task-front {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 15px;
            min-height: 250px;
        }
        
        .task-gallery-img {
            width: 100%;
            height: 120px;
            background: #f8f9fa;
            border-radius: 6px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .task-info-container {
            text-align: center;
            flex-grow: 1;
        }
        
        .task-gallery-name {
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 6px;
            color: #333;
        }
        
        .task-gallery-code {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 4px;
        }
        
        .task-gallery-qty {
            font-size: 0.85rem;
            color: #4361ee;
            font-weight: 600;
        }
        
        /* è°ƒè¯•æ ·å¼ */
        .debug-enabled .fixed-demo {
            outline: 3px solid #4cc9f0;
            background: linear-gradient(45deg, transparent 49%, rgba(76, 201, 240, 0.1) 49%, rgba(76, 201, 240, 0.1) 51%, transparent 51%);
        }
        
        .debug-enabled .fixed-demo .task-flip-container:nth-child(3n+1) {
            outline: 2px solid #4361ee;
        }
        
        .debug-enabled .fixed-demo .task-flip-container:nth-child(3n+2) {
            outline: 2px solid #7209b7;
        }
        
        .debug-enabled .fixed-demo .task-flip-container:nth-child(3n+3) {
            outline: 2px solid #f72585;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .fixed-demo {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
        }
        
        @media (max-width: 768px) {
            .fixed-demo {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .task-front {
                min-height: 220px;
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="text-center mb-4">ğŸ“¦ ä»“åº“ä»»åŠ¡å¡ç´§æ€¥ä¿®å¤éªŒè¯</h1>
        
        <!-- é—®é¢˜æ¼”ç¤ºåŒºåŸŸ -->
        <div class="section">
            <h3 class="section-title">âŒ å½“å‰é—®é¢˜æ¼”ç¤ºï¼ˆå‚ç›´å †å ï¼‰</h3>
            <div class="vertical-demo">
                <div class="task-flip-container" data-task-id="90">
                    <div class="task-front">
                        <div class="task-gallery-img">
                            <i class="fas fa-image fa-2x text-muted"></i>
                        </div>
                        <div class="task-info-container">
                            <div class="task-gallery-name">ç«‹ä½“æ‹¼å›¾åŠ¨ç‰©</div>
                            <div class="task-gallery-code">è´§å·: MZM-2032</div>
                            <div class="task-gallery-qty">æ•°é‡: 1 | ç®¡ç†å‘˜1</div>
                        </div>
                    </div>
                </div>
                
                <div class="task-flip-container" data-task-id="89">
                    <div class="task-front">
                        <div class="task-gallery-img">
                            <i class="fas fa-image fa-2x text-muted"></i>
                        </div>
                        <div class="task-info-container">
                            <div class="task-gallery-name">ç«‹ä½“æ‹¼å›¾äº¤é€š</div>
                            <div class="task-gallery-code">è´§å·: MZM-2033</div>
                            <div class="task-gallery-qty">æ•°é‡: 1 | ç®¡ç†å‘˜1</div>
                        </div>
                    </div>
                </div>
                
                <div class="task-flip-container" data-task-id="88">
                    <div class="task-front">
                        <div class="task-gallery-img">
                            <i class="fas fa-image fa-2x text-muted"></i>
                        </div>
                        <div class="task-info-container">
                            <div class="task-gallery-name">åŒ–å¦†å“åŒ…</div>
                            <div class="task-gallery-code">è´§å·: KABI-165</div>
                            <div class="task-gallery-qty">æ•°é‡: 1 | ç®¡ç†å‘˜1</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ä¿®å¤åæ¼”ç¤ºåŒºåŸŸ -->
        <div class="section">
            <h3 class="section-title">âœ… ä¿®å¤åæ•ˆæœï¼ˆç½‘æ ¼å¸ƒå±€ï¼‰</h3>
            <div class="fixed-demo">
                <div class="task-flip-container" data-task-id="90">
                    <div class="task-front">
                        <div class="task-gallery-img">
                            <i class="fas fa-image fa-2x text-muted"></i>
                        </div>
                        <div class="task-info-container">
                            <div class="task-gallery-name">ç«‹ä½“æ‹¼å›¾åŠ¨ç‰©</div>
                            <div class="task-gallery-code">è´§å·: MZM-2032</div>
                            <div class="task-gallery-qty">æ•°é‡: 1 | ç®¡ç†å‘˜1</div>
                        </div>
                    </div>
                </div>
                
                <div class="task-flip-container" data-task-id="89">
                    <div class="task-front">
                        <div class="task-gallery-img">
                            <i class="fas fa-image fa-2x text-muted"></i>
                        </div>
                        <div class="task-info-container">
                            <div class="task-gallery-name">ç«‹ä½“æ‹¼å›¾äº¤é€š</div>
                            <div class="task-gallery-code">è´§å·: MZM-2033</div>
                            <div class="task-gallery-qty">æ•°é‡: 1 | ç®¡ç†å‘˜1</div>
                        </div>
                    </div>
                </div>
                
                <div class="task-flip-container" data-task-id="88">
                    <div class="task-front">
                        <div class="task-gallery-img">
                            <i class="fas fa-image fa-2x text-muted"></i>
                        </div>
                        <div class="task-info-container">
                            <div class="task-gallery-name">åŒ–å¦†å“åŒ…</div>
                            <div class="task-gallery-code">è´§å·: KABI-165</div>
                            <div class="task-gallery-qty">æ•°é‡: 1 | ç®¡ç†å‘˜1</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æ§åˆ¶é¢æ¿ -->
        <div class="section">
            <h3 class="section-title">ğŸ› ï¸ æµ‹è¯•æ§åˆ¶</h3>
            <div class="row">
                <div class="col-md-6 mb-2">
                    <button class="btn btn-primary me-2" onclick="toggleDebug()">
                        <i class="fas fa-bug"></i> åˆ‡æ¢è°ƒè¯•æ¨¡å¼
                    </button>
                    <button class="btn btn-success" onclick="applyEmergencyFix()">
                        <i class="fas fa-magic"></i> åº”ç”¨ç´§æ€¥ä¿®å¤
                    </button>
                </div>
                <div class="col-md-6 mb-2">
                    <button class="btn btn-info me-2" onclick="addTaskCard()">
                        <i class="fas fa-plus"></i> æ·»åŠ ä»»åŠ¡å¡ç‰‡
                    </button>
                    <button class="btn btn-secondary" onclick="resetDemo()">
                        <i class="fas fa-redo"></i> é‡ç½®æ¼”ç¤º
                    </button>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-12">
                    <div class="alert alert-info">
                        <h5>ğŸ“‹ éªŒè¯è¦ç‚¹ï¼š</h5>
                        <ul>
                            <li>ä¸Šæ–¹ä¸¤ä¸ªåŒºåŸŸåº”è¯¥æ˜¾ç¤ºæ˜æ˜¾å·®å¼‚ï¼šä¸Šé¢æ˜¯å‚ç›´å †å ï¼Œä¸‹é¢æ˜¯ç½‘æ ¼å¸ƒå±€</li>
                            <li>ç‚¹å‡»"åº”ç”¨ç´§æ€¥ä¿®å¤"æŒ‰é’®åï¼Œä¸Šæ–¹çš„å‚ç›´æ˜¾ç¤ºåŒºåŸŸåº”è¯¥å˜ä¸ºç½‘æ ¼å¸ƒå±€</li>
                            <li>å¼€å¯è°ƒè¯•æ¨¡å¼å¯ä»¥æŸ¥çœ‹ç½‘æ ¼çº¿å’Œå¡ç‰‡è¾¹ç•Œ</li>
                            <li>æ·»åŠ æ–°å¡ç‰‡åº”è¯¥è‡ªåŠ¨æŒ‰ç…§ç½‘æ ¼å¸ƒå±€æ’åˆ—</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- è¯Šæ–­ä¿¡æ¯ -->
        <div class="section">
            <h3 class="section-title">ğŸ” å®æ—¶è¯Šæ–­</h3>
            <div id="diagnosis-output" class="bg-light p-3 rounded">
                ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®è·å–è¯Šæ–­ä¿¡æ¯...
            </div>
            <div class="mt-2">
                <button class="btn btn-outline-primary" onclick="runDiagnosis()">
                    <i class="fas fa-stethoscope"></i> è¿è¡Œè¯Šæ–­
                </button>
            </div>
        </div>
    </div>

    <script src="warehouse_layout_urgent_fix.js"></script>
    <script>
        let taskCounter = 91;
        
        function toggleDebug() {
            document.body.classList.toggle('debug-enabled');
            const isEnabled = document.body.classList.contains('debug-enabled');
            const btn = event.target;
            btn.innerHTML = isEnabled ? 
                '<i class="fas fa-bug"></i> ç¦ç”¨è°ƒè¯•æ¨¡å¼' : 
                '<i class="fas fa-bug"></i> å¼€å¯è°ƒè¯•æ¨¡å¼';
            btn.className = isEnabled ? 'btn btn-danger me-2' : 'btn btn-primary me-2';
            
            updateDiagnosisOutput(`è°ƒè¯•æ¨¡å¼${isEnabled ? 'å·²å¼€å¯' : 'å·²å…³é—­'}`);
        }
        
        function applyEmergencyFix() {
            if (window.WarehouseLayoutFix) {
                WarehouseLayoutFix.fix();
                updateDiagnosisOutput('âœ… ç´§æ€¥ä¿®å¤å·²åº”ç”¨åˆ°å‚ç›´æ¼”ç¤ºåŒºåŸŸ');
                
                // 3ç§’åå†æ¬¡è¯Šæ–­
                setTimeout(() => {
                    runDiagnosis();
                }, 3000);
            } else {
                updateDiagnosisOutput('âŒ ä¿®å¤è„šæœ¬æœªåŠ è½½');
            }
        }
        
        function addTaskCard() {
            const demoArea = document.querySelector('.vertical-demo');
            const fixedArea = document.querySelector('.fixed-demo');
            
            // ä¸ºä¸¤ä¸ªåŒºåŸŸéƒ½æ·»åŠ æ–°å¡ç‰‡
            [demoArea, fixedArea].forEach(area => {
                if (area) {
                    const newTask = document.createElement('div');
                    newTask.className = 'task-flip-container';
                    newTask.setAttribute('data-task-id', taskCounter);
                    newTask.innerHTML = `
                        <div class="task-front">
                            <div class="task-gallery-img">
                                <i class="fas fa-image fa-2x text-muted"></i>
                            </div>
                            <div class="task-info-container">
                                <div class="task-gallery-name">æ–°å¢ä»»åŠ¡ ${taskCounter}</div>
                                <div class="task-gallery-code">è´§å·: NEW-${taskCounter}</div>
                                <div class="task-gallery-qty">æ•°é‡: 1 | ç®¡ç†å‘˜1</div>
                            </div>
                        </div>
                    `;
                    area.appendChild(newTask);
                }
            });
            
            updateDiagnosisOutput(`âœ… å·²æ·»åŠ æ–°ä»»åŠ¡å¡ç‰‡ #${taskCounter}`);
            taskCounter++;
        }
        
        function resetDemo() {
            // é‡ç½®å‚ç›´æ¼”ç¤ºåŒºåŸŸ
            const verticalDemo = document.querySelector('.vertical-demo');
            verticalDemo.innerHTML = `
                <div class="task-flip-container" data-task-id="90">
                    <div class="task-front">
                        <div class="task-gallery-img">
                            <i class="fas fa-image fa-2x text-muted"></i>
                        </div>
                        <div class="task-info-container">
                            <div class="task-gallery-name">ç«‹ä½“æ‹¼å›¾åŠ¨ç‰©</div>
                            <div class="task-gallery-code">è´§å·: MZM-2032</div>
                            <div class="task-gallery-qty">æ•°é‡: 1 | ç®¡ç†å‘˜1</div>
                        </div>
                    </div>
                </div>
                
                <div class="task-flip-container" data-task-id="89">
                    <div class="task-front">
                        <div class="task-gallery-img">
                            <i class="fas fa-image fa-2x text-muted"></i>
                        </div>
                        <div class="task-info-container">
                            <div class="task-gallery-name">ç«‹ä½“æ‹¼å›¾äº¤é€š</div>
                            <div class="task-gallery-code">è´§å·: MZM-2033</div>
                            <div class="task-gallery-qty">æ•°é‡: 1 | ç®¡ç†å‘˜1</div>
                        </div>
                    </div>
                </div>
                
                <div class="task-flip-container" data-task-id="88">
                    <div class="task-front">
                        <div class="task-gallery-img">
                            <i class="fas fa-image fa-2x text-muted"></i>
                        </div>
                        <div class="task-info-container">
                            <div class="task-gallery-name">åŒ–å¦†å“åŒ…</div>
                            <div class="task-gallery-code">è´§å·: KABI-165</div>
                            <div class="task-gallery-qty">æ•°é‡: 1 | ç®¡ç†å‘˜1</div>
                        </div>
                    </div>
                </div>
            `;
            
            updateDiagnosisOutput('âœ… æ¼”ç¤ºå·²é‡ç½®');
        }
        
        function runDiagnosis() {
            const diagnosis = [];
            
            // æ£€æŸ¥å‚ç›´æ¼”ç¤ºåŒºåŸŸ
            const verticalDemo = document.querySelector('.vertical-demo');
            const verticalStyle = window.getComputedStyle(verticalDemo);
            diagnosis.push(`å‚ç›´æ¼”ç¤ºåŒºåŸŸ display: ${verticalStyle.display}`);
            diagnosis.push(`å‚ç›´æ¼”ç¤ºåŒºåŸŸ å­å…ƒç´ æ•°é‡: ${verticalDemo.children.length}`);
            
            // æ£€æŸ¥ç½‘æ ¼æ¼”ç¤ºåŒºåŸŸ
            const fixedDemo = document.querySelector('.fixed-demo');
            const fixedStyle = window.getComputedStyle(fixedDemo);
            diagnosis.push(`ç½‘æ ¼æ¼”ç¤ºåŒºåŸŸ display: ${fixedStyle.display}`);
            diagnosis.push(`ç½‘æ ¼æ¼”ç¤ºåŒºåŸŸ grid-template-columns: ${fixedStyle.gridTemplateColumns}`);
            diagnosis.push(`ç½‘æ ¼æ¼”ç¤ºåŒºåŸŸ å­å…ƒç´ æ•°é‡: ${fixedDemo.children.length}`);
            
            // æ£€æŸ¥ä¿®å¤è„šæœ¬
            diagnosis.push(`ä¿®å¤è„šæœ¬åŠ è½½çŠ¶æ€: ${window.WarehouseLayoutFix ? 'âœ… å·²åŠ è½½' : 'âŒ æœªåŠ è½½'}`);
            
            updateDiagnosisOutput(diagnosis.join('<br>'));
        }
        
        function updateDiagnosisOutput(message) {
            const output = document.getElementById('diagnosis-output');
            const timestamp = new Date().toLocaleTimeString();
            output.innerHTML = `[${timestamp}] ${message}`;
        }
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            updateDiagnosisOutput('ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆï¼Œå‡†å¤‡è¿›è¡Œä¿®å¤æµ‹è¯•');
        });
    </script>
</body>
</html>